module.exports=[406,(e,t,a)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},9901,e=>e.a(async(t,a)=>{try{let t=await e.y("cheerio-8dc19be4e357e3a4");e.n(t),a()}catch(e){a(e)}},!0),563,e=>e.a(async(t,a)=>{try{var r=e.i(9901),i=t([r]);function n(e){let t=r.load(e),a=[];return t(".gall_list tbody tr.us-post").each((e,r)=>{let i=t(r),n=i.find(".gall_num").text().trim();if(isNaN(parseInt(n)))return;let s=i.find(".gall_tit a").first().text().trim(),l=i.find(".gall_writer"),o=l.data("nick")||l.text().trim(),d=l.data("ip")||"",c=l.data("uid")||"",p=i.find(".gall_date"),u=p.attr("title"),m=p.text().trim();u&&a.push({id:n,title:s,author:o,ip:d,uid:c,timestamp:u,displayTime:m})}),a.reverse()}[r]=i.then?(await i)():i,e.s(["parseDCList",()=>n]),a()}catch(e){a(e)}},!1),5328,e=>e.a(async(t,a)=>{try{var r=e.i(563),i=t([r]);async function n(e,t){if("GET"!==e.method)return t.status(405).json({error:"Method not allowed"});let{url:a,targetTime:i,duration:n=60}=e.query;if(!a||!i)return t.status(400).json({error:"Missing required parameters: url, targetTime"});try{if(!new URL(a).hostname.includes("dcinside.com"))return t.status(400).json({error:"Invalid URL: Only dcinside.com URLs are allowed."})}catch(e){return t.status(400).json({error:"Invalid URL format."})}let s=(e=>{try{let t=new URL(e),a=t.searchParams.get("id"),r=t.hostname.includes("mgallery")||t.pathname.includes("mgallery");if(!a)return null;return{id:a,isMinor:r}}catch(e){return null}})(a);if(!s)return t.status(400).json({error:"Invalid DC Inside URL."});let{id:l,isMinor:o}=s,d=o?"https://gall.dcinside.com/mgallery/board/lists":"https://gall.dcinside.com/board/lists",c=new Date(i),p=new Date(c.getTime()+60*n*1e3);if(isNaN(c.getTime()))return t.status(400).json({error:"Invalid targetTime format."});let u=[],m=!1,g={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8",Referer:"https://gall.dcinside.com/"};console.log(`[Scrape] Start. URL: ${a}, Target: ${i} (${c.toString()})`);try{for(let e=1;e<=1e3&&!m;e+=5){console.log(`[Scrape] Batch ${e} ~ ${e+5-1}...`);let t=[];for(let a=0;a<5;a++){let r=e+a,i=`${d}?id=${l}&page=${r}`;t.push(fetch(i,{headers:g}).then(e=>e.text()))}for(let e of(await Promise.all(t))){let t=(0,r.parseDCList)(e);if(0===t.length)continue;let a=t[0];if(t[t.length-1],!a?.timestamp)continue;let i=new Date(a.timestamp);u.push(...t),i<=c&&(console.log(`[Scrape] Target reached! Oldest (${i.toString()}) <= Target (${c.toString()})`),m=!0)}}console.log(`[Scrape] Total Scraped Posts: ${u.length}`);let e=Array.from(new Map(u.map(e=>[e.id,e])).values()).filter(e=>{let t=new Date(e.timestamp);return t>=c&&t<=p});if(console.log(`[Scrape] Filtered Relevant Posts: ${e.length}`),e.sort((e,t)=>new Date(e.timestamp)-new Date(t.timestamp)),0===e.length)return console.log("[Scrape] Failed. No posts in range."),t.status(404).json({error:"No posts found in that time range (try increasing usage duration or checking date)."});t.status(200).json({posts:e,count:e.length})}catch(e){console.error("Scrape Error:",e),t.status(500).json({error:"Failed to scrape DC Inside."})}}[r]=i.then?(await i)():i,e.s(["default",()=>n]),a()}catch(e){a(e)}},!1),5237,e=>e.a(async(t,a)=>{try{var r=e.i(6747),i=e.i(9245),n=e.i(4898),s=e.i(2950),l=e.i(5328),o=e.i(7031),d=e.i(1927),c=e.i(6432),p=t([l]);[l]=p.then?(await p)():p;let m=(0,s.hoist)(l,"default"),g=(0,s.hoist)(l,"config"),h=new n.PagesAPIRouteModule({definition:{kind:i.RouteKind.PAGES_API,page:"/api/scrape",pathname:"/api/scrape",bundlePath:"",filename:""},userland:l,distDir:".next",relativeProjectDir:""});async function u(e,t,a){h.isDev&&(0,c.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let i="/api/scrape";i=i.replace(/\/index$/,"")||"/";let n=await h.prepare(e,t,{srcPage:i});if(!n){t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve());return}let{query:s,params:l,prerenderManifest:p,routerServerContext:u}=n;try{let a=e.method||"GET",r=(0,o.getTracer)(),n=r.getActiveScopeSpan(),c=h.instrumentationOnRequestError.bind(h),m=async n=>h.render(e,t,{query:{...s,...l},params:l,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:p.preview,propagateError:!1,dev:h.isDev,page:"/api/scrape",internalRevalidate:null==u?void 0:u.revalidate,onError:(...t)=>c(e,...t)}).finally(()=>{if(!n)return;n.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let e=r.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=e.get("next.route");if(s){let e=`${a} ${s}`;n.setAttributes({"next.route":s,"http.route":s,"next.span_name":e}),n.updateName(e)}else n.updateName(`${a} ${i}`)});n?await m(n):await r.withPropagatedContext(e.headers,()=>r.trace(d.BaseServerSpan.handleRequest,{spanName:`${a} ${i}`,kind:o.SpanKind.SERVER,attributes:{"http.method":a,"http.target":e.url}},m))}catch(e){if(h.isDev)throw e;(0,r.sendError)(t,500,"Internal Server Error")}finally{null==a.waitUntil||a.waitUntil.call(a,Promise.resolve())}}e.s(["config",0,g,"default",0,m,"handler",()=>u]),a()}catch(e){a(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__19ae3f34._.js.map