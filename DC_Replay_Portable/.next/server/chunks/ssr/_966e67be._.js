module.exports=[9059,(a,b,c)=>{b.exports=a.r(1276)},1914,a=>{a.v({activeTab:"Home-module__Ho9lYW__activeTab",author:"Home-module__Ho9lYW__author",chatContainer:"Home-module__Ho9lYW__chatContainer",container:"Home-module__Ho9lYW__container",content:"Home-module__Ho9lYW__content",controlRow:"Home-module__Ho9lYW__controlRow",controlsArea:"Home-module__Ho9lYW__controlsArea",fadeInContainer:"Home-module__Ho9lYW__fadeInContainer",header:"Home-module__Ho9lYW__header",headerTitle:"Home-module__Ho9lYW__headerTitle",heatmapBar:"Home-module__Ho9lYW__heatmapBar",heatmapContainer:"Home-module__Ho9lYW__heatmapContainer",iconButton:"Home-module__Ho9lYW__iconButton",inputField:"Home-module__Ho9lYW__inputField",ip:"Home-module__Ho9lYW__ip",labelRow:"Home-module__Ho9lYW__labelRow",labelText:"Home-module__Ho9lYW__labelText",landingContainer:"Home-module__Ho9lYW__landingContainer",leftControls:"Home-module__Ho9lYW__leftControls",loadingText:"Home-module__Ho9lYW__loadingText",messageBubble:"Home-module__Ho9lYW__messageBubble",messagesArea:"Home-module__Ho9lYW__messagesArea",metaRow:"Home-module__Ho9lYW__metaRow",playButton:"Home-module__Ho9lYW__playButton",progressBar:"Home-module__Ho9lYW__progressBar",progressFill:"Home-module__Ho9lYW__progressFill",pulse:"Home-module__Ho9lYW__pulse",rightControls:"Home-module__Ho9lYW__rightControls",row:"Home-module__Ho9lYW__row",scrapeButton:"Home-module__Ho9lYW__scrapeButton",scrapeForm:"Home-module__Ho9lYW__scrapeForm",slideInMessage:"Home-module__Ho9lYW__slideInMessage",speedSelect:"Home-module__Ho9lYW__speedSelect",tabButton:"Home-module__Ho9lYW__tabButton",tabContainer:"Home-module__Ho9lYW__tabContainer",time:"Home-module__Ho9lYW__time",timeDisplay:"Home-module__Ho9lYW__timeDisplay",timeInput:"Home-module__Ho9lYW__timeInput"})},3184,a=>{"use strict";var b=a.i(9168),c=a.i(7068),d=a.i(2759),e=a.i(7684),f=a.i(6695),g=a.i(8171),h=a.i(7669),i=a.i(9059),j=a.i(1914);function k(){let[a,b]=(0,h.useState)([]),[c,d]=(0,h.useState)(!1),[e,f]=(0,h.useState)(0),[k,l]=(0,h.useState)([]),[m,n]=(0,h.useState)(null),[o,p]=(0,h.useState)(null),[q,r]=(0,h.useState)(1),[s,t]=(0,h.useState)(null),[u,v]=(0,h.useState)([]),[w,x]=(0,h.useState)("scrape"),[y,z]=(0,h.useState)(""),[A,B]=(0,h.useState)("");(0,h.useEffect)(()=>{},[]);let[C,D]=(0,h.useState)(60),[E,F]=(0,h.useState)(!1),[G,H]=(0,h.useState)(16),[I,J]=(0,h.useState)(!0),K=(0,h.useRef)(null),L=(0,h.useRef)(null),M=(0,h.useRef)(null);(0,h.useEffect)(()=>{K.current?.scrollIntoView({behavior:"smooth"})},[k]);let N=a=>{let b={};a.forEach(a=>{let c=a.timestamp;b[c]||(b[c]=[]),b[c].push(a)});let c=[];return Object.values(b).forEach(a=>{let b=a.length;if(1===b){let b=a[0];b.virtualTimestamp=new Date(b.timestamp).getTime(),c.push(b)}else{let d=1e3/b;a.forEach((a,b)=>{let e=new Date(a.timestamp).getTime();a.virtualTimestamp=e+d*b,c.push(a)})}}),c.sort((a,b)=>a.virtualTimestamp-b.virtualTimestamp)},O=a=>{if(0===a.length)return;let b=a[0].virtualTimestamp,c=a[a.length-1].virtualTimestamp-b;if(c<=0)return;let d=c/50,e=Array(50).fill(0);a.forEach(a=>{let c=Math.min(Math.floor((a.virtualTimestamp-b)/d),49);e[c]++});let f=Math.max(...e);v(e.map(a=>({count:a,height:0===a?0:a/f*100})))},P=async()=>{if(!y||!A)return void alert("Please enter URL and Start Time");F(!0);try{let a=await fetch(`/api/scrape?url=${encodeURIComponent(y)}&targetTime=${A}&duration=${C}`),c=await a.json();if(c.posts&&c.posts.length>0){let a=N(c.posts);b(a),l([]),f(0);let d=new Date(a[0].virtualTimestamp),e=new Date(A),g=d<e?d:e;n(g),p(g),t(new Date(a[a.length-1].virtualTimestamp)),O(a)}else alert(c.error||"No posts found.")}catch(a){console.error(a),alert("Scraping failed. Check console.")}finally{F(!1)}},Q=async a=>{let c=a.target.files?.[0];if(!c)return;let d=await c.text();try{let a=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html:d})}),c=await a.json();if(c.posts&&c.posts.length>0){let a=N(c.posts);b(a),l([]),f(0);let d=new Date(a[0].virtualTimestamp),e=new Date(a[a.length-1].virtualTimestamp);n(d),t(e),p(d),O(a)}else alert("No posts found in this file. Make sure it is a DC Inside Gallery List.")}catch(a){console.error(a),alert("Failed to parse file.")}};(0,h.useEffect)(()=>{c&&(clearInterval(L.current),L.current=setInterval(()=>{p(a=>{let b=new Date(a.getTime()+100*q);return s&&b>s?(clearInterval(L.current),d(!1),s):b})},100))},[q]),(0,h.useEffect)(()=>{if(!o||0===a.length)return;let b=o.getTime();if(k.length>0&&k[k.length-1].virtualTimestamp>b){let c=a.filter(a=>a.virtualTimestamp<=b);l(c),f(c.length);return}let c=e,d=[];for(;c<a.length;){let e=a[c];if(e.virtualTimestamp<=b)d.push(e),c++;else break}d.length>0&&(l(a=>[...a,...d]),f(c))},[o,a]);let R=a=>{if(!o)return;let b=new Date(o.getTime()+1e3*a);m&&b<m?p(m):s&&b>s?p(s):p(b)},S=m&&s&&o?(o.getTime()-m.getTime())/(s.getTime()-m.getTime())*100:0;return(0,g.jsxs)("div",{className:j.default.container,children:[(0,g.jsxs)(i.default,{children:[(0,g.jsx)("title",{children:"DC Replay Chat"}),(0,g.jsx)("meta",{name:"description",content:"Replay DC Inside reactions"})]}),(0,g.jsx)("main",{children:0===a.length?(0,g.jsxs)("div",{className:j.default.landingContainer,children:[(0,g.jsxs)("div",{className:j.default.tabContainer,children:[(0,g.jsx)("button",{className:`${j.default.tabButton} ${"upload"===w?j.default.activeTab:""}`,onClick:()=>x("upload"),children:"File Upload"}),(0,g.jsx)("button",{className:`${j.default.tabButton} ${"scrape"===w?j.default.activeTab:""}`,onClick:()=>x("scrape"),children:"Auto Scrape"})]}),"upload"===w?(0,g.jsxs)("label",{className:j.default.uploadZone,children:[(0,g.jsx)("input",{type:"file",onChange:Q,accept:".html",style:{display:"none"}}),(0,g.jsxs)("div",{style:{textAlign:"center"},children:[(0,g.jsx)("h3",{children:"Drop DC Gallery HTML File Here"}),(0,g.jsx)("p",{children:'Right click "Save As" on the list page, then upload.'})]})]}):(0,g.jsxs)("div",{className:j.default.scrapeForm,children:[(0,g.jsx)("input",{type:"text",className:j.default.inputField,placeholder:"Gallery URL (e.g. https://gall.dcinside.com/...)",value:y,onChange:a=>z(a.target.value)}),(0,g.jsxs)("div",{className:j.default.labelRow,children:[(0,g.jsx)("span",{className:j.default.labelText,children:"Target Date & Time"}),(0,g.jsx)("span",{className:j.default.labelText,children:"Replay Duration"})]}),(0,g.jsxs)("div",{className:j.default.row,children:[(0,g.jsx)("input",{type:"datetime-local",className:j.default.inputField,value:A,onChange:a=>B(a.target.value)}),(0,g.jsxs)("select",{className:j.default.inputField,value:C,onChange:a=>D(Number(a.target.value)),children:[(0,g.jsx)("option",{value:30,children:"30 Mins"}),(0,g.jsx)("option",{value:60,children:"1 Hour"}),(0,g.jsx)("option",{value:120,children:"2 Hours"}),(0,g.jsx)("option",{value:180,children:"3 Hours"}),(0,g.jsx)("option",{value:360,children:"6 Hours (Slow)"}),(0,g.jsx)("option",{value:720,children:"12 Hours (Risk)"})]})]}),C>=360&&(0,g.jsx)("div",{style:{color:"#fbbf24",fontSize:"0.8rem",marginTop:"-0.5rem"},children:"⚠️ Long durations on active galleries may take 5-10 mins to scrape."}),(0,g.jsx)("button",{className:j.default.scrapeButton,onClick:P,disabled:E,children:E?"Searching & Scraping...":"Start Replay"}),E&&(0,g.jsx)("div",{className:j.default.loadingText,children:"Searching backwards for your date..."})]})]}):(0,g.jsxs)("div",{className:j.default.chatContainer,children:[(0,g.jsxs)("div",{className:j.default.header,children:[(0,g.jsx)("span",{className:j.default.headerTitle,children:"Live Reactions"}),(0,g.jsx)("div",{className:j.default.timeDisplay,children:o?o.toTimeString().split(" ")[0]:"00:00:00"})]}),(0,g.jsxs)("div",{className:j.default.messagesArea,children:[k.map((a,b)=>(0,g.jsxs)("div",{className:j.default.messageBubble,children:[(0,g.jsxs)("div",{className:j.default.metaRow,children:[(0,g.jsx)("span",{className:j.default.author,children:a.author}),(0,g.jsx)("span",{className:j.default.ip,children:a.ip?`(${a.ip})`:(a.uid,"")}),(0,g.jsx)("span",{className:j.default.time,children:a.displayTime})]}),(0,g.jsx)("div",{className:j.default.content,style:{fontSize:`${G}px`},children:a.title})]},b)),(0,g.jsx)("div",{ref:K})]}),(0,g.jsxs)("div",{className:j.default.controlsArea,children:[(0,g.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"0.2rem",gap:"1rem"},children:(0,g.jsxs)("label",{style:{fontSize:"0.8rem",color:"#94a3b8",display:"flex",alignItems:"center",gap:"0.3rem",cursor:"pointer"},children:[(0,g.jsx)("input",{type:"checkbox",checked:I,onChange:a=>J(a.target.checked)}),"Show Heatmap"]})}),(0,g.jsxs)("div",{className:j.default.progressBar,onClick:a=>{if(!m||!s||!M.current)return;let b=M.current.getBoundingClientRect(),c=a.clientX-b.left,d=b.width,e=s.getTime()-m.getTime();p(new Date(m.getTime()+c/d*e))},ref:M,title:"Click to seek",children:[I&&(0,g.jsx)("div",{className:j.default.heatmapContainer,children:u.map((a,b)=>(0,g.jsx)("div",{className:j.default.heatmapBar,style:{height:`${a.height}%`,opacity:.5+a.height/200}},b))}),(0,g.jsx)("div",{className:j.default.progressFill,style:{width:`${S}%`}})]}),(0,g.jsxs)("div",{className:j.default.controlRow,children:[(0,g.jsx)("div",{className:j.default.leftControls,children:(0,g.jsxs)("select",{className:j.default.speedSelect,value:q,onChange:a=>r(Number(a.target.value)),children:[(0,g.jsx)("option",{value:1,children:"1.0x"}),(0,g.jsx)("option",{value:2,children:"2.0x"}),(0,g.jsx)("option",{value:5,children:"5.0x"}),(0,g.jsx)("option",{value:10,children:"10.0x"})]})}),(0,g.jsxs)("div",{className:j.default.centerControls,children:[(0,g.jsx)("button",{className:j.default.iconButton,onClick:()=>R(-10),children:"-10"}),(0,g.jsx)("button",{className:j.default.playButton,onClick:()=>{c?(clearInterval(L.current),d(!1)):(d(!0),L.current=setInterval(()=>{p(a=>{let b=new Date(a.getTime()+100*q);return s&&b>s?(clearInterval(L.current),d(!1),s):b})},100))},children:c?"⏸":"▶"}),(0,g.jsx)("button",{className:j.default.iconButton,onClick:()=>R(10),children:"+10"})]}),(0,g.jsxs)("div",{className:j.default.rightControls,children:[(0,g.jsx)("input",{type:"text",className:j.default.timeInput,placeholder:"HH:MM:SS",onKeyDown:a=>{if("Enter"===a.key){let b=a.target.value;if(!m)return;let[c,d,e]=b.split(":").map(Number);if(isNaN(c)||isNaN(d)||isNaN(e))return;let f=new Date(m);f.setHours(c),f.setMinutes(d),f.setSeconds(e),p(f),a.target.value=""}}}),(0,g.jsxs)("div",{style:{display:"flex",gap:"2px",background:"rgba(0,0,0,0.3)",borderRadius:"6px",padding:"2px"},children:[(0,g.jsx)("button",{className:j.default.iconButton,onClick:()=>H(Math.max(12,G-2)),style:{fontSize:"0.8rem",width:"24px",height:"24px",padding:0},title:"Decrease Font",children:"-"}),(0,g.jsx)("span",{style:{fontSize:"0.8rem",padding:"0 4px",lineHeight:"24px",color:"#ccc"},children:"Aa"}),(0,g.jsx)("button",{className:j.default.iconButton,onClick:()=>H(Math.min(24,G+2)),style:{fontSize:"0.8rem",width:"24px",height:"24px",padding:0},title:"Increase Font",children:"+"})]})]})]})]})]})})]})}a.s(["default",()=>k],5532);var l=a.i(5532),m=a.i(9193);let n=(0,d.hoist)(l,"default"),o=(0,d.hoist)(l,"getStaticProps"),p=(0,d.hoist)(l,"getStaticPaths"),q=(0,d.hoist)(l,"getServerSideProps"),r=(0,d.hoist)(l,"config"),s=(0,d.hoist)(l,"reportWebVitals"),t=(0,d.hoist)(l,"unstable_getStaticProps"),u=(0,d.hoist)(l,"unstable_getStaticPaths"),v=(0,d.hoist)(l,"unstable_getStaticParams"),w=(0,d.hoist)(l,"unstable_getServerProps"),x=(0,d.hoist)(l,"unstable_getServerSideProps"),y=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/index",pathname:"/",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:l}),z=(0,m.getHandler)({srcPage:"/index",config:r,userland:l,routeModule:y,getStaticPaths:p,getStaticProps:o,getServerSideProps:q});a.s(["config",0,r,"default",0,n,"getServerSideProps",0,q,"getStaticPaths",0,p,"getStaticProps",0,o,"handler",0,z,"reportWebVitals",0,s,"routeModule",0,y,"unstable_getServerProps",0,w,"unstable_getServerSideProps",0,x,"unstable_getStaticParams",0,v,"unstable_getStaticPaths",0,u,"unstable_getStaticProps",0,t],3184)}];

//# sourceMappingURL=_966e67be._.js.map